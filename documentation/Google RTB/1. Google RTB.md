# Google RTB

## 입찰 프로토콜 선정 기준

현재 구글 Authorized Buyers에서 제공하는 입찰 프로토콜은 다음과 같다.

- Google RTB
- OpenRTB 2.2
- OpenRTB 2.3
- OpenRTB 프로토콜 버퍼 2.3
- OpenRTB 2.4
- OpenRTB 프로토콜 버퍼 2.4
- OpenRTB 2.5
- OpenRTB 프로토콜 버퍼 2.5

IAB에서 정의한 OpenRTB 프로토콜은 시간이 지남에 따라 여러 기능이 추가되어 버전이 계속 업그레이드 되고 있다. Authorized Buyers에서 입찰자 엔드포인트 설정시 변경이 어려우므로 구글에서 정의한 Google RTB를 입찰 프로토콜로 사용하여 버전 변경 없이 지속적으로 서비스 가능하도록 하는게 가장 올바른 선택으로 예상된다.



[Protos & Reference Data](https://developers.google.com/authorized-buyers/rtb/data)

![Protos](https://user-images.githubusercontent.com/12541721/167626821-4bfb726a-98ed-4e35-8137-300122a0361c.png)





## realtime-bidding.proto

구글 RTB 프로토콜은 realtime-bidding.proto 를 사용하며, 단일 입찰 요청 전문에는 하나의 노출이 ad slot 형태로 포함된다. 

[Authorized Buyers Real-time Bidding Protocol Buffer](https://developers.google.com/authorized-buyers/rtb/downloads/realtime-bidding-proto)



### realtime-bidding.proto 를 프로젝트에 맞게 수정 

```protobuf
// Protocol version: v.237
// Copyright 2022 Google Inc. All Rights Reserved.
syntax = "proto2";

option java_multiple_files = true;
option java_package = "com.example.protobuf.google";

import "google/protobuf/duration.proto";
import "google/protobuf/struct.proto";

// This is the message that Google uses to request bids. A BidRequest
// includes the ad slot from a single impression.
//
message BidRequest {
  // Unique request id generated by Google. This is 16 bytes long.
  required bytes id = 2;
  
  // 이하 생략 
}
```

- syntax 지정 추가 
  - syntax = "proto2";
- 단일 클래스가 아닌 여러 클래스가 생성 되도록 옵션 추가 
  - option java_multiple_files = true;
- 생성된 클래스가 저장될 디렉토리 옵션 추가
  - option java_package = "com.example.protobuf.google"



### realtime-bidding.proto 컴파일 

![image](https://user-images.githubusercontent.com/12541721/167764421-ada99ba4-2425-4eb2-907d-58b8f9c598c0.png)







